"use strict";var app=angular.module("midotApp",["ngAnimate","ngCookies","ngResource","ngRoute","ngSanitize","ngTouch","times.tabletop"]);app.config(["TabletopProvider",function(a){a.setTabletopOptions({key:"https://docs.google.com/spreadsheets/d/1tZL7qG6Ysbv_nB0XZR487pBKwKvGdGAv1ObaYPwqf8U/pubhtml?gid=1195003145&single=true"})}]),angular.module("midotApp").controller("MainCtrl",function(){this.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}),angular.module("midotApp").controller("AboutCtrl",function(){this.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}),angular.module("midotApp").factory("rows",["Tabletop","$q",function(a,b){return b(function(b){a.then(function(a){var c={amutot:a[0].amutot.elements,subjects:_.object(_.map(a[0].subjects.elements,function(a){return[a.subject,a.text]}))};b(c)})})}]),angular.module("midotApp").controller("MainpageCtrl",["rows","$scope","$filter",function(a,b,c){function d(a,b){var c=_.countBy(a,b),d=_.max(_.values(c));return c=_.sortBy(_.pairs(c),function(a){return-a[1]}),_.forEach(c,function(a){a.push(100*a[1]/d),a.push(b)}),c}function e(){var a=c("filter")(f.rows,b.query),e={};b.selectedMainChar&&(a=c("fieldFilter")(a,"main_char",b.selectedMainChar.main_char)),b.selectedVolume2013Granular&&(a=c("fieldFilter")(a,"volume_2013_granular",b.selectedVolume2013Granular.volume_2013_granular)),b.selectedLocationArea&&(a=c("fieldFilter")(a,"location_area",b.selectedLocationArea.location_area)),b.selectedOperationField&&(a=c("fieldFilter")(a,["operation_field","operation_field_2"],b.selectedOperationField)),f.filteredRows=a,b.selectedMainChar||(e["מאפיין ראשי"]=d(a,"main_char")),b.selectedVolume2013Granular||(e["מחזור כספי"]=d(a,"volume_2013_granular")),b.selectedMainChar&&!b.selectedOperationField&&(e["תחום פעולה ראשי"]=d(a,"operation_field")),b.selectedStat&&b.selectedStat in e||(b.selectedStat=_.keys(e)[0]),console.log(e),f.stats=e}var f=this;this.selectedRow=null,this.rows=[],a.then(function(a){f.rows=a.amutot,f.subjects=a.subjects,f.stats={},f.operation_fields=_.union(_.map(f.rows,function(a){return a.operation_field}),_.map(f.rows,function(a){return a.operation_field_2})),e()}),b.$watchGroup(["query","selectedMainChar","selectedVolume2013Granular","selectedLocationArea","selectedOperationField"],function(){e()}),this.onHover=function(a,b){if(f.selectedRow=a,null!==a){var c=$(b.currentTarget),d=c.width(),e=c.closest(".row").width();console.log(d,e);var g=c.height(),h=$("#detail-card"),i=c.offset();h.css("width",e+"px"),i?(console.log(i),h.css("position","absolute"),h.css("top",i.top+22+g+"px"),h.css("right",i.left-e+d+"px")):h.css("position","static")}}}]),angular.module("midotApp").filter("unique",function(){return function(a,b){return b?_.uniq(a,!1,function(a){return a[b]}):_.uniq(a,!1)}}),angular.module("midotApp").filter("fieldFilter",function(){return function(a,b,c){return c?b.constructor===Array?_.filter(a,function(a){return _.some(b,function(b){return a[b]===c})}):_.filter(a,function(a){return a[b]===c}):a}}),angular.module("midotApp").run(["$templateCache",function(a){a.put("views/about.html","<p>This is the about view.</p>"),a.put("views/main.html",'<div class="jumbotron"> <h1>\'Allo, \'Allo!</h1> <p class="lead"> <img src="images/yeoman.png" alt="I\'m Yeoman"><br> Always a pleasure scaffolding your apps. </p> <p><a class="btn btn-lg btn-success" ng-href="#/">Splendid!<span class="glyphicon glyphicon-ok"></span></a></p> </div> <div class="row marketing"> <h4>HTML5 Boilerplate</h4> <p> HTML5 Boilerplate is a professional front-end template for building fast, robust, and adaptable web apps or sites. </p> <h4>Angular</h4> <p> AngularJS is a toolset for building the framework most suited to your application development. </p> <h4>Karma</h4> <p>Spectacular Test Runner for JavaScript.</p> </div>')}]);